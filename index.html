<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrossFit Team Lift Optimizer</title>
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2ecc71;
            --accent: #e74c3c;
            --dark: #2c3e50;
            --light: #ecf0f1;
            --gray: #95a5a6;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: var(--gray);
        }
        
        .input-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .person-input {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background-color: #f8f9fa;
        }
        
        .person-name {
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }
        
        .lift-input {
            margin-bottom: 12px;
        }
        
        .lift-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .button-container {
            text-align: center;
            margin: 20px 0;
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1.1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .results-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            display: none;
        }
        
        .results-header {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .assignment-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .assignment-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            background-color: #f8f9fa;
        }
        
        .assignment-card.best {
            border: 2px solid var(--secondary);
            background-color: #e8f6ef;
        }
        
        .assignment-title {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: var(--dark);
        }
        
        .assignment-detail {
            margin-bottom: 8px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-label {
            color: var(--gray);
            margin-top: 5px;
        }
        
        .chart-container {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .chart-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--dark);
        }
        
        .chart-bars {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .chart-bar {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .chart-bar-label {
            min-width: 120px;
            font-weight: 500;
        }
        
        .chart-bar-track {
            flex-grow: 1;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
        }
        
        .chart-bar-fill {
            height: 100%;
            background: var(--primary);
            border-radius: 15px;
            transition: width 1s ease-out;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
        }
        
        .chart-bar-fill.best {
            background: var(--secondary);
        }
        
        .loading {
            text-align: center;
            display: none;
            margin: 20px 0;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--primary);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .assignment-results {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-bar {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .chart-bar-track {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>CrossFit Team Lift Optimizer</h1>
            <p class="subtitle">Maximize your team's total weight by finding the optimal lift assignments</p>
        </header>
        
        <section class="input-section">
            <h2>Enter Estimated 3-Rep Maxes</h2>
            <p>For each team member, enter your estimated 3-rep max weight and your uncertainty (¬± pounds).</p>
            
            <div class="input-grid">
                <div class="person-input" id="ben-input">
                    <h3 class="person-name">Ben</h3>
                    <div class="lift-input">
                        <label class="lift-label">Front Squat (lbs)</label>
                        <input type="number" min="0" class="weight-input" data-person="ben" data-lift="frontSquat" placeholder="Weight">
                        <input type="number" min="0" class="uncertainty-input" data-person="ben" data-lift="frontSquat" placeholder="¬± Uncertainty">
                    </div>
                    <div class="lift-input">
                        <label class="lift-label">Push Jerk (lbs)</label>
                        <input type="number" min="0" class="weight-input" data-person="ben" data-lift="pushJerk" placeholder="Weight">
                        <input type="number" min="0" class="uncertainty-input" data-person="ben" data-lift="pushJerk" placeholder="¬± Uncertainty">
                    </div>
                    <div class="lift-input">
                        <label class="lift-label">Overhead Squat (lbs)</label>
                        <input type="number" min="0" class="weight-input" data-person="ben" data-lift="overheadSquat" placeholder="Weight">
                        <input type="number" min="0" class="uncertainty-input" data-person="ben" data-lift="overheadSquat" placeholder="¬± Uncertainty">
                    </div>
                </div>
                
                <div class="person-input" id="mason-input">
                    <h3 class="person-name">Mason</h3>
                    <div class="lift-input">
                        <label class="lift-label">Front Squat (lbs)</label>
                        <input type="number" min="0" class="weight-input" data-person="mason" data-lift="frontSquat" placeholder="Weight">
                        <input type="number" min="0" class="uncertainty-input" data-person="mason" data-lift="frontSquat" placeholder="¬± Uncertainty">
                    </div>
                    <div class="lift-input">
                        <label class="lift-label">Push Jerk (lbs)</label>
                        <input type="number" min="0" class="weight-input" data-person="mason" data-lift="pushJerk" placeholder="Weight">
                        <input type="number" min="0" class="uncertainty-input" data-person="mason" data-lift="pushJerk" placeholder="¬± Uncertainty">
                    </div>
                    <div class="lift-input">
                        <label class="lift-label">Overhead Squat (lbs)</label>
                        <input type="number" min="0" class="weight-input" data-person="mason" data-lift="overheadSquat" placeholder="Weight">
                        <input type="number" min="0" class="uncertainty-input" data-person="mason" data-lift="overheadSquat" placeholder="¬± Uncertainty">
                    </div>
                </div>
                
                <div class="person-input" id="brendan-input">
                    <h3 class="person-name">Brendan</h3>
                    <div class="lift-input">
                        <label class="lift-label">Front Squat (lbs)</label>
                        <input type="number" min="0" class="weight-input" data-person="brendan" data-lift="frontSquat" placeholder="Weight">
                        <input type="number" min="0" class="uncertainty-input" data-person="brendan" data-lift="frontSquat" placeholder="¬± Uncertainty">
                    </div>
                    <div class="lift-input">
                        <label class="lift-label">Push Jerk (lbs)</label>
                        <input type="number" min="0" class="weight-input" data-person="brendan" data-lift="pushJerk" placeholder="Weight">
                        <input type="number" min="0" class="uncertainty-input" data-person="brendan" data-lift="pushJerk" placeholder="¬± Uncertainty">
                    </div>
                    <div class="lift-input">
                        <label class="lift-label">Overhead Squat (lbs)</label>
                        <input type="number" min="0" class="weight-input" data-person="brendan" data-lift="overheadSquat" placeholder="Weight">
                        <input type="number" min="0" class="uncertainty-input" data-person="brendan" data-lift="overheadSquat" placeholder="¬± Uncertainty">
                    </div>
                </div>
            </div>
            
            <div class="button-container">
                <button id="run-simulation">Run Simulation</button>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Running simulations... This may take a moment.</p>
            </div>
        </section>
        
        <section class="results-section" id="results-section">
            <h2 class="results-header">Optimal Assignment Results</h2>
            
            <div class="assignment-results" id="assignment-results">
                <!-- Results will be populated here -->
            </div>
            
            <div class="stats-grid" id="stats-grid">
                <!-- Stats will be populated here -->
            </div>
            
            <div class="chart-container">
                <h3 class="chart-title">Win Percentage by Assignment</h3>
                <div class="chart-bars" id="chart-bars">
                    <!-- Chart bars will be populated here -->
                </div>
            </div>
        </section>
        
        <footer>
            <p>CrossFit Team Lift Optimizer ‚Ä¢ Created for Ben, Mason, and Brendan</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const runButton = document.getElementById('run-simulation');
            const loadingElement = document.getElementById('loading');
            const resultsSection = document.getElementById('results-section');
            const assignmentResults = document.getElementById('assignment-results');
            const statsGrid = document.getElementById('stats-grid');
            const chartBars = document.getElementById('chart-bars');
            
            // All possible assignments (each person to a different lift)
            const assignments = [
                { 
                    name: "Assignment 1", 
                    ben: "frontSquat", 
                    mason: "pushJerk", 
                    brendan: "overheadSquat" 
                },
                { 
                    name: "Assignment 2", 
                    ben: "frontSquat", 
                    mason: "overheadSquat", 
                    brendan: "pushJerk" 
                },
                { 
                    name: "Assignment 3", 
                    ben: "pushJerk", 
                    mason: "frontSquat", 
                    brendan: "overheadSquat" 
                },
                { 
                    name: "Assignment 4", 
                    ben: "pushJerk", 
                    mason: "overheadSquat", 
                    brendan: "frontSquat" 
                },
                { 
                    name: "Assignment 5", 
                    ben: "overheadSquat", 
                    mason: "frontSquat", 
                    brendan: "pushJerk" 
                },
                { 
                    name: "Assignment 6", 
                    ben: "overheadSquat", 
                    mason: "pushJerk", 
                    brendan: "frontSquat" 
                }
            ];
            
            // Get lift display names
            function getLiftDisplayName(lift) {
                const liftNames = {
                    frontSquat: "Front Squat",
                    pushJerk: "Push Jerk",
                    overheadSquat: "Overhead Squat"
                };
                return liftNames[lift] || lift;
            }
            
            // Collect input data
            function getInputData() {
                const data = {
                    ben: {},
                    mason: {},
                    brendan: {}
                };
                
                // Get all weight and uncertainty inputs
                const weightInputs = document.querySelectorAll('.weight-input');
                const uncertaintyInputs = document.querySelectorAll('.uncertainty-input');
                
                // Process weight inputs
                weightInputs.forEach(input => {
                    const person = input.dataset.person;
                    const lift = input.dataset.lift;
                    const value = parseFloat(input.value) || 0;
                    
                    if (!data[person][lift]) {
                        data[person][lift] = {};
                    }
                    
                    data[person][lift].weight = value;
                });
                
                // Process uncertainty inputs
                uncertaintyInputs.forEach(input => {
                    const person = input.dataset.person;
                    const lift = input.dataset.lift;
                    const value = parseFloat(input.value) || 0;
                    
                    if (!data[person][lift]) {
                        data[person][lift] = {};
                    }
                    
                    data[person][lift].uncertainty = value;
                });
                
                return data;
            }
            
            // Generate a random value from a normal distribution
            function normalRandom(mean, stdDev) {
                let u = 0, v = 0;
                while(u === 0) u = Math.random();
                while(v === 0) v = Math.random();
                const normal = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
                return mean + stdDev * normal;
            }
            
            // Run Monte Carlo simulation
            function runSimulation(data, iterations = 1000) {
                const results = {
                    assignments: assignments.map(a => ({ 
                        ...a, 
                        totalScores: [],
                        average: 0,
                        min: Infinity,
                        max: -Infinity
                    })),
                    bestCount: Array(assignments.length).fill(0)
                };
                
                // Run simulations
                for (let i = 0; i < iterations; i++) {
                    let bestScore = -1;
                    let bestAssignmentIndex = -1;
                    
                    // For each assignment, calculate total score
                    assignments.forEach((assignment, index) => {
                        // Calculate score for this assignment
                        let total = 0;
                        
                        // Ben's lift
                        const benLift = assignment.ben;
                        const benData = data.ben[benLift];
                        const benWeight = Math.max(0, normalRandom(benData.weight, benData.uncertainty / 2));
                        total += benWeight;
                        
                        // Mason's lift
                        const masonLift = assignment.mason;
                        const masonData = data.mason[masonLift];
                        const masonWeight = Math.max(0, normalRandom(masonData.weight, masonData.uncertainty / 2));
                        total += masonWeight;
                        
                        // Brendan's lift
                        const brendanLift = assignment.brendan;
                        const brendanData = data.brendan[brendanLift];
                        const brendanWeight = Math.max(0, normalRandom(brendanData.weight, brendanData.uncertainty / 2));
                        total += brendanWeight;
                        
                        // Store results
                        results.assignments[index].totalScores.push(total);
                        
                        if (total > bestScore) {
                            bestScore = total;
                            bestAssignmentIndex = index;
                        }
                    });
                    
                    // Count this as a win for the best assignment
                    if (bestAssignmentIndex >= 0) {
                        results.bestCount[bestAssignmentIndex]++;
                    }
                }
                
                // Calculate statistics for each assignment
                results.assignments.forEach(assignment => {
                    const scores = assignment.totalScores;
                    if (scores.length > 0) {
                        assignment.average = scores.reduce((sum, score) => sum + score, 0) / scores.length;
                        assignment.min = Math.min(...scores);
                        assignment.max = Math.max(...scores);
                    }
                });
                
                return results;
            }
            
            // Display results
            function displayResults(data, results) {
                // Clear previous results
                assignmentResults.innerHTML = '';
                statsGrid.innerHTML = '';
                chartBars.innerHTML = '';
                
                // Find the best assignment (most wins)
                let bestAssignmentIndex = 0;
                let maxWins = -1;
                
                results.bestCount.forEach((count, index) => {
                    if (count > maxWins) {
                        maxWins = count;
                        bestAssignmentIndex = index;
                    }
                });
                
                // Display each assignment
                results.assignments.forEach((assignment, index) => {
                    const isBest = index === bestAssignmentIndex;
                    const winPercentage = (results.bestCount[index] / results.bestCount.reduce((a, b) => a + b, 0)) * 100;
                    
                    const card = document.createElement('div');
                    card.className = `assignment-card ${isBest ? 'best' : ''}`;
                    
                    card.innerHTML = `
                        <h3 class="assignment-title">${assignment.name} ${isBest ? 'üèÜ' : ''}</h3>
                        <p class="assignment-detail"><strong>Ben:</strong> ${getLiftDisplayName(assignment.ben)}</p>
                        <p class="assignment-detail"><strong>Mason:</strong> ${getLiftDisplayName(assignment.mason)}</p>
                        <p class="assignment-detail"><strong>Brendan:</strong> ${getLiftDisplayName(assignment.brendan)}</p>
                        <p class="assignment-detail"><strong>Win Rate:</strong> ${winPercentage.toFixed(1)}%</p>
                        <p class="assignment-detail"><strong>Avg. Total:</strong> ${assignment.average.toFixed(1)} lbs</p>
                    `;
                    
                    assignmentResults.appendChild(card);
                });
                
                // Display statistics for the best assignment
                const bestAssignment = results.assignments[bestAssignmentIndex];
                
                statsGrid.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-value">${bestAssignment.average.toFixed(1)}</div>
                        <div class="stat-label">Average Total (lbs)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${bestAssignment.min.toFixed(1)}</div>
                        <div class="stat-label">Minimum Total (lbs)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${bestAssignment.max.toFixed(1)}</div>
                        <div class="stat-label">Maximum Total (lbs)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">${(results.bestCount[bestAssignmentIndex] / results.bestCount.reduce((a, b) => a + b, 0) * 100).toFixed(1)}%</div>
                        <div class="stat-label">Probability of Being Best</div>
                    </div>
                `;
                
                // Create horizontal bar chart for win percentages
                results.bestCount.forEach((count, index) => {
                    const percentage = (count / results.bestCount.reduce((a, b) => a + b, 0)) * 100;
                    const isBest = index === bestAssignmentIndex;
                    
                    const barElement = document.createElement('div');
                    barElement.className = 'chart-bar';
                    
                    barElement.innerHTML = `
                        <div class="chart-bar-label">${assignments[index].name}:</div>
                        <div class="chart-bar-track">
                            <div class="chart-bar-fill ${isBest ? 'best' : ''}" style="width: ${percentage}%">
                                ${percentage.toFixed(1)}%
                            </div>
                        </div>
                    `;
                    
                    chartBars.appendChild(barElement);
                });
                
                // Show results section
                resultsSection.style.display = 'block';
            }
            
            // Event listener for the run simulation button
            runButton.addEventListener('click', function() {
                // Show loading indicator
                loadingElement.style.display = 'block';
                
                // Get input data
                const inputData = getInputData();
                
                // Check if all fields are filled
                let allFieldsFilled = true;
                for (const person in inputData) {
                    for (const lift in inputData[person]) {
                        if (inputData[person][lift].weight === 0 || inputData[person][lift].uncertainty === undefined) {
                            allFieldsFilled = false;
                            break;
                        }
                    }
                    if (!allFieldsFilled) break;
                }
                
                if (!allFieldsFilled) {
                    alert('Please fill in all weight and uncertainty fields before running the simulation.');
                    loadingElement.style.display = 'none';
                    return;
                }
                
                // Run simulation after a brief delay to allow the UI to update
                setTimeout(function() {
                    const results = runSimulation(inputData, 5000); // 5000 iterations for accuracy
                    
                    // Hide loading indicator
                    loadingElement.style.display = 'none';
                    
                    // Display results
                    displayResults(inputData, results);
                }, 100);
            });
        });
    </script>
</body>
</html>